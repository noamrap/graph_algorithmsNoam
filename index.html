<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×××œ×›×ª ×”××œ×’×•×¨×™×ª××™× - × ×•×¢× ×¨×¤×•×¤×•×¨×˜</title>
    <style>
        /* --- ××©×ª× ×™× ×•×¢×™×¦×•×‘ ×‘×¡×™×¡×™ (High Tech / Royal) --- */
        :root {
            --bg-core: #050b14;
            --bg-panel: #0f172a;
            --border: #1e293b;
            --primary: #00f3ff; /* Cyan Neon */
            --gold: #ffd700; /* Gold */
            --accent: #ff0055; /* Neon Red */
            --success: #00ff9d; /* Matrix Green */
            --text-main: #e2e8f0;
            --text-dim: #94a3b8;
            --font-ui: 'Segoe UI', system-ui, sans-serif;
            --font-mono: 'Consolas', 'Monaco', monospace;
        }

        * {
            box-sizing: border-box;
            outline: none;
            user-select: none;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-core);
            color: var(--text-main);
            font-family: var(--font-ui);
            height: 100vh;
            overflow: hidden;
        }

        /* --- ××¡×š ×¤×ª×™×—×” (SPLASH SCREEN) --- */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease-in-out, transform 0.8s ease-in-out;
        }

        .fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .royal-card {
            background: rgba(0, 0, 0, 0.7);
            border: 3px solid var(--gold);
            padding: 50px 80px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 60px rgba(255, 215, 0, 0.25);
            backdrop-filter: blur(10px);
            animation: float 4s ease-in-out infinite;
            position: relative;
        }

        .crown {
            font-size: 5rem;
            display: block;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 10px var(--gold));
            animation: spin 8s infinite linear;
        }

        .royal-title {
            color: var(--gold);
            font-size: 1.4rem;
            letter-spacing: 4px;
            text-transform: uppercase;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .royal-name {
            font-size: 3.5rem;
            font-weight: 900;
            margin: 0;
            background: linear-gradient(to right, #00f3ff, #fff, var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 243, 255, 0.4);
        }

        .funny-subtitle {
            color: #bbb;
            font-style: italic;
            margin-top: 15px;
            font-size: 1.1rem;
            min-height: 1.5em;
            font-family: var(--font-mono);
        }

        .start-btn-large {
            margin-top: 50px;
            padding: 18px 60px;
            font-size: 1.6rem;
            background: var(--primary);
            color: #000;
            border: none;
            border-radius: 50px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 0 25px var(--primary);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

            .start-btn-large:hover {
                transform: scale(1.1);
                box-shadow: 0 0 50px var(--primary);
                background: #fff;
            }

            .start-btn-large:active {
                transform: scale(0.95);
            }

        /* --- ×××©×§ ×¨××©×™ --- */
        #app-interface {
            display: none;
            height: 100vh;
            grid-template-rows: 70px 1fr;
            opacity: 0;
            transition: opacity 1s ease-in;
        }

        header {
            background: rgba(15, 23, 42, 0.98);
            border-bottom: 1px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            z-index: 100;
        }

        .app-logo {
            font-size: 1.3rem;
            font-weight: 800;
            color: #fff;
            letter-spacing: 1px;
        }

        .nav-pills {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            padding: 8px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            font-size: 0.95rem;
        }

            .nav-btn:hover {
                color: #fff;
                border-color: var(--primary);
                background: rgba(0, 243, 255, 0.05);
            }

            .nav-btn.active {
                background: rgba(0, 243, 255, 0.15);
                color: var(--primary);
                border-color: var(--primary);
                box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
            }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 450px; /* ×”×¨×—×‘×ª×™ ×§×¦×ª ××ª ×”×¡×¨×’×œ ×”×¦×™×“×™ */
            height: 100%;
            overflow: hidden;
        }

        /* STAGE (Graph Area) */
        .stage {
            background-image: radial-gradient(#1e293b 1px, transparent 1px);
            background-size: 30px 30px;
            position: relative;
            overflow: hidden;
            box-shadow: inset -10px 0 20px rgba(0,0,0,0.5);
        }

        svg {
            width: 100%;
            height: 100%;
            cursor: grab;
        }

            svg:active {
                cursor: grabbing;
            }

        /* Elements */
        .edge {
            stroke: #334155;
            stroke-width: 2;
            transition: 0.3s;
        }

            .edge.active {
                stroke: var(--gold);
                stroke-width: 5;
                filter: drop-shadow(0 0 5px var(--gold));
            }

            .edge.visited {
                stroke: var(--primary);
                opacity: 0.4;
                stroke-width: 3;
            }

        .label-bg {
            fill: var(--bg-core);
            stroke: var(--border);
            rx: 4;
        }

        .label-text {
            fill: var(--text-main);
            font-size: 13px;
            font-family: var(--font-mono);
            font-weight: bold;
            text-anchor: middle;
            dominant-baseline: central;
        }

        .node-circle {
            fill: var(--bg-panel);
            stroke: var(--text-dim);
            stroke-width: 3px;
            r: 32;
            transition: 0.3s;
        }

        .node-text {
            fill: white;
            font-size: 18px;
            font-weight: bold;
            font-family: var(--font-mono);
            text-anchor: middle;
            dominant-baseline: central;
        }

        .node-badge {
            font-size: 11px;
            fill: var(--gold);
            font-weight: bold;
            text-anchor: middle;
            opacity: 0;
            transition: 0.3s;
            font-family: var(--font-mono);
        }

        .group.active .node-circle {
            stroke: var(--gold);
            fill: #3f2e04;
            transform: scale(1.15);
            box-shadow: 0 0 20px var(--gold);
        }

        .group.visited .node-circle {
            stroke: var(--primary);
            fill: rgba(0, 243, 255, 0.15);
        }

        .group.finished .node-circle {
            stroke: var(--success);
            fill: rgba(0, 255, 157, 0.15);
        }

        /* SIDEBAR - ×¢×™×¦×•×‘ ××—×•×“×© ×œ×˜×™×¤×•×œ ×‘××§×•× */
        .sidebar {
            background: var(--bg-panel);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            z-index: 10;
            box-shadow: -5px 0 30px rgba(0,0,0,0.5);
            height: 100%; /* ×—×•×‘×” ×œ×ª×¤×•×¡ ××ª ×›×œ ×”×’×•×‘×” */
        }

        .panel {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            background: rgba(0,0,0,0.2);
            flex-shrink: 0; /* ××•× ×¢ ×›×™×•×•×¥ ×©×œ ×”×¤×× ×œ×™× ×”×¢×œ×™×•× ×™×, ××‘×œ... */
        }

        .panel-title {
            margin: 0 0 8px 0;
            color: var(--primary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
        }

        /* Explanation Box */
        .explanation-box {
            background: rgba(255, 255, 255, 0.05);
            border-right: 3px solid var(--gold);
            padding: 10px;
            font-size: 0.85rem;
            line-height: 1.5;
            color: #d1d5db;
            /* ×©×™×¤×•×¨ ××©××¢×•×ª×™: ×’×œ×™×œ×” ×¤× ×™××™×ª ×œ×˜×§×¡×˜ ×›×“×™ ×œ× ×œ×ª×¤×•×¡ ××§×•× ××”×œ×•×’ */
            max-height: 120px; 
            overflow-y: auto;
        }

        /* ×¢×™×¦×•×‘ ×¤×¡ ×’×œ×™×œ×” ×™×¤×” ×œ×ª×™×‘×ª ×”×”×¡×‘×¨ */
        .explanation-box::-webkit-scrollbar { width: 6px; }
        .explanation-box::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
        .explanation-box::-webkit-scrollbar-thumb { background: var(--text-dim); border-radius: 3px; }

        .ds-items {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            height: 50px;
            align-items: center;
            padding-bottom: 5px;
            scrollbar-width: thin;
        }

        .ds-item {
            min-width: 40px;
            height: 40px;
            background: var(--bg-core);
            border: 1px solid var(--border);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-mono);
            font-weight: bold;
            font-size: 0.9rem;
            transition: 0.3s;
            color: var(--text-main);
        }

            .ds-item.active {
                border-color: var(--gold);
                color: var(--gold);
                transform: translateY(-3px);
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
            }

        /* LOGS AREA - ×”×ª×™×§×•×Ÿ ×”×’×“×•×œ */
        .log-wrapper {
            /* ×”×˜×¨×™×§ ×”×—×©×•×‘: */
            flex: 1; /* ×ª×•×¤×¡ ××ª ×›×œ ×”××§×•× ×”×¤× ×•×™ */
            min-height: 0; /* ×××¤×©×¨ ×œ×™×œ×“×™× ×©×œ×• ×œ×’×œ×•×œ ×‘××§×•× ×œ××ª×•×— ××ª ×”××™×›×œ */
            
            display: flex;
            flex-direction: column;
            background: #080c14;
            position: relative;
            border-bottom: 1px solid var(--border);
        }

        .log-header {
            padding: 10px 15px;
            background: rgba(255,255,255,0.02);
            font-size: 0.8rem;
            color: var(--text-dim);
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .log-container {
            /* ×’×œ×™×œ×” ×¤× ×™××™×ª ×‘×œ×‘×“ */
            overflow-y: auto; 
            height: 100%;
            
            padding: 15px;
            font-family: var(--font-mono);
            font-size: 0.95rem; /* ×’×•×¤×Ÿ ×§×¦×ª ×™×•×ª×¨ ×’×“×•×œ ×œ×§×¨×™××•×ª */
            line-height: 1.6;
            scroll-behavior: smooth;
        }

            .log-container::-webkit-scrollbar {
                width: 10px;
            }

            .log-container::-webkit-scrollbar-track {
                background: #080c14;
            }

            .log-container::-webkit-scrollbar-thumb {
                background: #334155;
                border-radius: 4px;
                border: 2px solid #080c14;
            }

                .log-container::-webkit-scrollbar-thumb:hover {
                    background: var(--primary);
                }

        .log-entry {
            margin-bottom: 8px;
            padding: 10px 12px;
            border-radius: 6px;
            background: rgba(255,255,255,0.03);
            border-right: 4px solid transparent;
            animation: slideIn 0.2s;
        }

        .l-info { border-color: var(--text-dim); color: var(--text-dim); }
        .l-act { border-color: var(--primary); color: #befafe; background: rgba(0, 243, 255, 0.08); }
        .l-calc { border-color: var(--gold); color: #fef08a; }
        .l-success { border-color: var(--success); color: #bef264; background: rgba(0, 255, 157, 0.08); }
        .l-err { border-color: var(--accent); color: #fca5a5; }

        /* CONTROLS */
        .controls {
            padding: 20px;
            background: var(--bg-panel);
            /* ××™×Ÿ ×’×‘×•×œ ×¢×œ×™×•×Ÿ ×›×™ ×œ-log-wrapper ×™×© ×’×‘×•×œ ×ª×—×ª×•×Ÿ */
            flex-shrink: 0; /* ×©×œ× ×™×ª×›×•×•×¥ */
        }

        .control-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .control-label {
            font-size: 0.85rem;
            color: var(--text-dim);
        }

        select.custom-select {
            background: var(--bg-core);
            color: var(--text-main);
            border: 1px solid var(--border);
            padding: 5px 10px;
            border-radius: 5px;
            font-family: var(--font-mono);
            cursor: pointer;
        }

            select.custom-select:hover {
                border-color: var(--primary);
            }

        .btn-row {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .c-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: #fff;
            transition: 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

            .c-btn:active {
                transform: scale(0.95);
            }

        .btn-play {
            background: var(--primary);
            color: #000;
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
        }

            .btn-play:hover {
                box-shadow: 0 0 20px var(--primary);
            }

        .btn-step {
            background: var(--bg-core);
            border: 2px solid var(--text-dim);
            color: var(--text-main);
        }

            .btn-step:hover {
                border-color: var(--gold);
                color: var(--gold);
            }

        .btn-reset {
            width: 40px;
            height: 40px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            font-size: 1rem;
        }

            .btn-reset:hover {
                color: #fff;
                border-color: #fff;
            }

        input[type=range] {
            width: 100px;
            accent-color: var(--primary);
            height: 4px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes spin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>

    <div id="splash-screen">
        <div class="royal-card" onclick="changeJoke()">
            <div class="crown">ğŸ‘‘</div>
            <div class="royal-title">×”×©×œ×™×˜ ×”×‘×œ×ª×™ ××¢×•×¨×¢×¨</div>
            <h2 class="royal-name">× ×•×¢× ×¨×¤×•×¤×•×¨×˜</h2>
            <div class="funny-subtitle" id="jokeText">×××™×™×Ÿ ××¢×¨×›×™× ×‘××‘×˜ ×‘×œ×‘×“...</div>
            <button id="startTrigger" class="start-btn-large">×”×ª×—×œ ×œ×œ××•×“ ğŸš€</button>
        </div>
        <div style="margin-top:20px; color:#666; font-size:0.8rem">×œ×—×¥ ×¢×œ ×”×›×¨×˜×™×¡ ×›×“×™ ×œ×”×—×œ×™×£ ×¢×•×‘×“×”</div>
    </div>

    <div id="app-interface">
        <header>
            <div class="app-logo">Algo<span style="color:var(--primary)">Lab</span> Pro</div>
            <div class="nav-pills">
                <button class="nav-btn active" onclick="app.load('Dijkstra')">Dijkstra</button>
                <button class="nav-btn" onclick="app.load('BFS')">BFS</button>
                <button class="nav-btn" onclick="app.load('DFS')">DFS</button>
                <button class="nav-btn" onclick="app.load('SCC')">SCC</button>
                <button class="nav-btn" onclick="app.load('DAG')">DAG</button>
                <button class="nav-btn" onclick="app.load('Bellman')">Bellman</button>
            </div>
        </header>

        <div class="main-grid">
            <div class="stage">
                <svg id="svgLayer">
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="7" refX="34" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#334155" />
                        </marker>
                        <marker id="arrow-active" markerWidth="10" markerHeight="7" refX="34" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#ffd700" />
                        </marker>
                    </defs>
                    <g id="g-edges"></g>
                    <g id="g-nodes"></g>
                </svg>
            </div>

            <div class="sidebar">

                <div class="panel">
                    <div class="panel-title">
                        <span id="algoNameDisplay">Dijkstra</span>
                    </div>
                    <div class="explanation-box" id="algoExplanation">
                        ×˜×•×¢×Ÿ ×”×¡×‘×¨...
                    </div>
                </div>

                <div class="panel" style="max-height: 100px;">
                    <div class="panel-title">
                        <span id="dsTitle">××‘× ×” × ×ª×•× ×™×</span>
                        <span style="font-size:0.7rem; opacity:0.7; color:var(--success)">LIVE</span>
                    </div>
                    <div class="ds-items" id="dsContainer"></div>
                </div>

                <div class="log-wrapper">
                    <div class="log-header">×™×•××Ÿ ×¨×™×¦×” ×•×”×¡×‘×¨×™× (Logs)</div>
                    <div class="log-container" id="logBox">
                        <div class="log-entry l-info">×”××¢×¨×›×ª ××•×›× ×”. ×‘×—×¨ ××œ×’×•×¨×™×ª× ×•×”×ª×—×œ ×œ×¨×•×¥.</div>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <span class="control-label">×§×•×“×§×•×“ ×”×ª×—×œ×”:</span>
                        <select id="startNodeSelect" class="custom-select" onchange="app.changeStartNode()"></select>
                    </div>

                    <div class="control-group">
                        <span class="control-label">××”×™×¨×•×ª:</span>
                        <input type="range" id="speedRange" min="100" max="2500" value="1200" step="100" dir="ltr">
                    </div>

                    <div class="btn-row">
                        <button class="c-btn btn-reset" onclick="app.reset()" title="××ª×—×•×œ ××—×“×©">â†º</button>
                        <button class="c-btn btn-play" id="playBtn" onclick="app.toggleAuto()" title="× ×’×Ÿ / ×”×©×”×”">â–¶</button>
                        <button class="c-btn btn-step" onclick="app.manualStep()" title="×¦×¢×“ ×™×“× ×™">âœ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* --- ×œ×•×’×™×§×ª ×¤×ª×™×— --- */
        const jokes = [
            "××—×©×‘ ××¡×œ×•×œ ×§×¦×¨ ×œ××§×¨×¨...",
            "×¤×ª×¨ ××ª P=NP ×‘×”×¤×¡×§×ª ×§×¤×”",
            "Dijkstra ××¢×ª×™×§ ××× ×• ×‘××‘×—× ×™×",
            "×¨×¥ ×‘×¡×™×‘×•×›×™×•×ª O(1)",
            "×”××™×©, ×”××’×“×”, ×•×”×§×•×“×§×•×“",
            "×œ× ×¦×¨×™×š GPS, ×™×© ×œ×• BFS",
            "××›×™×¨ ××ª ×›×œ ×”××¢×’×œ×™× ×”×©×œ×™×œ×™×™× ×‘×©×›×•× ×”",
            "×‘× ×” ××ª ×”××™× ×˜×¨× ×˜ ××’×¨×£ ××›×•×•×Ÿ"
        ];

        function changeJoke() {
            const el = document.getElementById('jokeText');
            el.style.opacity = 0;
            setTimeout(() => {
                el.innerText = jokes[Math.floor(Math.random() * jokes.length)];
                el.style.opacity = 1;
            }, 200);
        }
        setInterval(changeJoke, 3500);

        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("startTrigger").addEventListener("click", () => {
                const splash = document.getElementById('splash-screen');
                const interface = document.getElementById('app-interface');
                splash.classList.add('fade-out');
                setTimeout(() => {
                    splash.style.display = 'none';
                    interface.style.display = 'grid';
                    void interface.offsetWidth;
                    interface.style.opacity = '1';
                    app.load('Dijkstra');
                }, 800);
            });
        });

        /* --- ×ª×™××•×¨×™×” ×•×”×¡×‘×¨×™× ××•×¨×—×‘×™× --- */
        const EXPLANATIONS = {
            'Dijkstra': `
                <b>××˜×¨×”:</b> ××¦×™××ª ×”××¡×œ×•×œ ×”×§×¦×¨ ×‘×™×•×ª×¨ ××’×¨×£ ×××•×©×§×œ (××©×§×œ×™× ×—×™×•×‘×™×™× ×‘×œ×‘×“).<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ××œ×’×•×¨×™×ª× ×—××“×Ÿ (Greedy). ×©×•××¨×™× ×ª××™×“ ××ª ×”××¨×—×§ ×”××™× ×™××œ×™ ×©××¦×× ×• ×¢×“ ×›×”. ×‘×•×—×¨×™× ××ª ×”×§×•×“×§×•×“ ×”×–×•×œ ×‘×™×•×ª×¨ ×©×˜×¨× ×¡×™×™×× ×• ××™×ª×•, ×•××‘×¦×¢×™× "Relaxation" (×ª×™×§×•×Ÿ) ×œ×©×›× ×™× ×©×œ×•.<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×©×™× ×œ×‘ ××™×š ×”××œ×’×•×¨×™×ª× "××ª×¤×©×˜" ××”×–×•×œ ×œ×™×§×¨. ×‘×’×¨×£ ×¢× ××©×§×œ×™× ×—×™×•×‘×™×™×, ×‘×¨×’×¢ ×©×¡×™×™×× ×• ×œ×¢×‘×“ ×§×•×“×§×•×“, ×”××¨×—×§ ××œ×™×• ×”×•× ×¡×•×¤×™ ×•××•×‘×˜×—.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(E log V)
            `,
            'BFS': `
                <b>××˜×¨×”:</b> ×¡×¨×™×§×” ×œ×¨×•×—×‘ (×©×›×‘×•×ª). ××¦×•×™×Ÿ ×œ××¦×™××ª ××¡×œ×•×œ ×§×¦×¨ ×‘×™×•×ª×¨ ×‘×’×¨×£ *×œ×* ×××•×©×§×œ.<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ××©×ª××©×™× ×‘×ª×•×¨ (Queue - FIFO). ××›× ×™×¡×™× ××ª ×”×”×ª×—×œ×”, ×•××– ××•×¦×™××™× ××—×“, ×•××›× ×™×¡×™× ××ª ×›×œ ×”×©×›× ×™× ×©×œ×• ×©×˜×¨× ×¨××™× ×•.<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×©×™× ×œ×‘ ×œ××¤×§×˜ ×”"××“×•×•×”" (Ripple Effect). ×”×¡×¨×™×§×” ××ª×§×“××ª ×‘××¢×’×œ×™× ×©×•×•×™× ×× ×§×•×“×ª ×”×”×ª×—×œ×”. ×›×œ ×”×©×›× ×™× ×‘××¨×—×§ 1 × ×¡×¨×§×™× ×œ×¤× ×™ ×”×©×›× ×™× ×‘××¨×—×§ 2.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(V + E)
            `,
            'DFS': `
                <b>××˜×¨×”:</b> ×¡×¨×™×§×” ×œ×¢×•××§. ×©×™××•×©×™ ×œ×’×™×œ×•×™ ×¨×›×™×‘×™× ×§×©×™×¨×™×, ××™×•×Ÿ ×˜×•×¤×•×œ×•×’×™, ×•×¤×ª×¨×•×Ÿ ××‘×•×›×™×.<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ××©×ª××©×™× ×‘××—×¡× ×™×ª (Stack - LIFO) ××• ×‘×¨×§×•×¨×¡×™×”. ×¦×•×œ×œ×™× ×¢××•×§ ×›×›×œ ×”××¤×©×¨ ×œ×ª×•×š ×¢× ×£, ×•×›×©× ×ª×§×¢×™× - ×—×•×–×¨×™× ××—×•×¨×” (Backtracking).<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×©×™× ×œ×‘ ××™×š ×”××œ×’×•×¨×™×ª× ××ª×¢×œ× ××©×›× ×™× ×§×¨×•×‘×™× ×•×¨×¥ ×œ×§×¦×” ×”×’×¨×£. ×”×•× ×™×›×•×œ ×œ××¦×•× ××¡×œ×•×œ, ××‘×œ ×œ× ××‘×˜×™×— ×©×–×” ×”××¡×œ×•×œ ×”×§×¦×¨ ×‘×™×•×ª×¨.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(V + E)
            `,
            'SCC': `
                <b>××˜×¨×”:</b> ××¦×™××ª ×¨×›×™×‘×™× ×§×©×™×¨×™× ×”×™×˜×‘ (Strongly Connected Components) - ×§×‘×•×¦×•×ª ×©×‘×”×Ÿ ×™×© ××¡×œ×•×œ ××›×œ ××—×“ ×œ×›×œ ××—×“.<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ×”××œ×’×•×¨×™×ª× ×©×œ Tarjan. ××©×ª××© ×‘-DFS ×•×‘×¢×¨×›×™ Low-Link ×›×“×™ ×œ×–×”×•×ª "××¢×’×œ×™×" ×•×§×©×ª×•×ª ××—×•×¨×™×•×ª.<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×—×¤×© ×‘×œ×•×’ ××ª ×¢×“×›×•× ×™ ×”-Low-Link. ×× ×¢×¨×š ×”-Low ×©×œ ×§×•×“×§×•×“ × ×©××¨ ×©×•×•×” ×œ-ID ×©×œ×• ××—×¨×™ ×©×—×–×¨× ×• ××›×œ ×”×©×›× ×™×, ×¡×™××Ÿ ×©×”×•× "×©×•×¨×©" ×©×œ ×¨×›×™×‘ ×§×©×™×¨.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(V + E)
            `,
            'DAG': `
                <b>××˜×¨×”:</b> ××¡×œ×•×œ ×§×¦×¨ ×‘×™×•×ª×¨ ×‘×’×¨×£ ××›×•×•×Ÿ ×œ×œ× ××¢×’×œ×™× (DAG).<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ×©×œ×‘ ×': ××™×•×Ÿ ×˜×•×¤×•×œ×•×’×™ (×¡×™×“×•×¨ ×”×§×•×“×§×•×“×™× ×‘×§×• ×›×š ×©×›×œ ×”×—×¦×™× ×¤×•× ×™× ×™××™× ×”). ×©×œ×‘ ×‘': ××¢×‘×¨ ×¤×©×•×˜ ××—×“ ×¢×œ ×”××™×•×Ÿ ×•×¢×“×›×•×Ÿ ××¨×—×§×™×.<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×–×”×• ×”××§×¨×” ×”×™×¢×™×œ ×‘×™×•×ª×¨. ×‘×’×œ×œ ×©××™×Ÿ ××¢×’×œ×™×, ×× ×—× ×• ×œ× ×¦×¨×™×›×™× ×œ×•×œ××•×ª ××•×¨×›×‘×•×ª ××• Priority Queue. ×¡×“×¨ ×”×¤×¢×•×œ×•×ª ×”×•× ×œ×™× ×™××¨×™ ×œ×—×œ×•×˜×™×Ÿ.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(V + E)
            `,
            'Bellman': `
                <b>××˜×¨×”:</b> ××¡×œ×•×œ ×§×¦×¨ ×‘×™×•×ª×¨ ×‘×’×¨×£ ×¢× ××©×§×œ×™× ×©×œ×™×œ×™×™×.<br>
                <b>××™×š ×–×” ×¢×•×‘×“?</b> ×‘××§×•× ×œ×‘×—×•×¨ ×§×•×“×§×•×“ ××—×“ ×‘×›×œ ×¤×¢× (×›××• ×“×™×™×§×¡×˜×¨×”), ×× ×—× ×• ×¢×•×‘×¨×™× ×¢×œ *×›×œ* ×”×§×©×ª×•×ª ×‘×’×¨×£ ×•×× ×¡×™× ×œ×©×¤×¨ ××¨×—×§×™×, ×©×•×‘ ×•×©×•×‘, |V|-1 ×¤×¢××™×.<br>
                <b>××” ×œ×œ××•×“ ××–×”?</b> ×©×™× ×œ×‘ ××™×š ×”××¨×—×§×™× ××ª×¢×“×›× ×™× ×œ××˜. ×‘×¡×•×£, ×× ×• ××‘×¦×¢×™× ×¡×™×‘×•×‘ × ×•×¡×£ ×›×“×™ ×œ×¨××•×ª ×× ×¢×“×™×™×Ÿ ×™×© ×©×™×¤×•×¨ - ×× ×›×Ÿ, ×™×© ××¢×’×œ ×©×œ×™×œ×™.<br>
                <span style="color:var(--primary)">×¡×™×‘×•×›×™×•×ª:</span> O(V * E)
            `
        };

        /* --- × ×ª×•× ×™ ×’×¨×¤×™× --- */
        const SCENARIOS = {
            GENERAL: {
                nodes: [0, 1, 2, 3, 4, 5],
                edges: [
                    { u: 0, v: 1, w: 5 }, { u: 0, v: 2, w: 2 }, { u: 1, v: 2, w: 6 }, { u: 1, v: 3, w: 1 }, { u: 1, v: 4, w: 10 },
                    { u: 2, v: 3, w: 9 }, { u: 2, v: 4, w: 1 }, { u: 3, v: 4, w: 7 }, { u: 3, v: 5, w: 1 }, { u: 4, v: 5, w: 5 }, { u: 5, v: 1, w: 2 }
                ],
                pos: { 0: { x: 100, y: 300 }, 1: { x: 300, y: 150 }, 2: { x: 300, y: 450 }, 3: { x: 600, y: 150 }, 4: { x: 600, y: 450 }, 5: { x: 800, y: 300 } }
            },
            DAG: {
                nodes: [0, 1, 2, 3, 4, 5],
                edges: [
                    { u: 0, v: 1, w: 2 }, { u: 0, v: 2, w: 6 }, { u: 1, v: 2, w: 7 }, { u: 1, v: 3, w: 4 }, { u: 1, v: 4, w: 2 },
                    { u: 2, v: 3, w: -1 }, { u: 2, v: 4, w: 1 }, { u: 3, v: 4, w: -2 }, { u: 4, v: 5, w: 2 }
                ],
                pos: { 0: { x: 80, y: 300 }, 1: { x: 250, y: 150 }, 2: { x: 250, y: 450 }, 3: { x: 500, y: 150 }, 4: { x: 500, y: 450 }, 5: { x: 700, y: 300 } }
            },
            BELLMAN: {
                nodes: [1, 2, 3, 4],
                edges: [
                    { u: 1, v: 2, w: 4 }, { u: 1, v: 3, w: 2 }, { u: 2, v: 3, w: 1 }, { u: 3, v: 2, w: 1 },
                    { u: 2, v: 4, w: 4 }, { u: 3, v: 4, w: 2 }, { u: 4, v: 2, w: -2 }
                ],
                pos: { 1: { x: 150, y: 300 }, 2: { x: 450, y: 150 }, 3: { x: 450, y: 450 }, 4: { x: 750, y: 300 } }
            }
        };

        /* --- ×× ×•×¢ ×”××¤×œ×™×§×¦×™×” --- */
        class App {
            constructor() {
                this.graph = SCENARIOS.GENERAL;
                this.algo = 'Dijkstra';
                this.gen = null;
                this.isPlaying = false;
                this.timer = null;
                this.selectedStartNode = null;

                this.els = {
                    edges: document.getElementById('g-edges'),
                    nodes: document.getElementById('g-nodes'),
                    log: document.getElementById('logBox'),
                    ds: document.getElementById('dsContainer'),
                    dsTitle: document.getElementById('dsTitle'),
                    playBtn: document.getElementById('playBtn'),
                    speed: document.getElementById('speedRange'),
                    startSelect: document.getElementById('startNodeSelect'),
                    explanation: document.getElementById('algoExplanation'),
                    algoNameDisplay: document.getElementById('algoNameDisplay')
                };
            }

            load(name) {
                this.algo = name;
                this.els.algoNameDisplay.innerText = name;
                this.els.explanation.innerHTML = EXPLANATIONS[name] || "×”×¡×‘×¨ ×‘×˜×¢×™× ×”...";

                document.querySelectorAll('.nav-btn').forEach(b => {
                    b.classList.remove('active');
                    if (b.innerText === name) b.classList.add('active');
                });

                // ×‘×—×™×¨×ª ×’×¨×£ ××ª××™×
                if (name === 'Bellman') this.graph = SCENARIOS.BELLMAN;
                else if (name === 'DAG') this.graph = SCENARIOS.DAG;
                else this.graph = SCENARIOS.GENERAL;

                // ×¢×“×›×•×Ÿ ×¨×©×™××ª ×§×•×“×§×•×“×™ ×”×ª×—×œ×”
                this.populateStartNodes();
                this.reset();
            }

            populateStartNodes() {
                this.els.startSelect.innerHTML = '';
                this.graph.nodes.forEach((n) => {
                    const opt = document.createElement('option');
                    opt.value = n;
                    opt.innerText = `×§×•×“×§×•×“ ${n}`;
                    this.els.startSelect.appendChild(opt);
                });

                // ×‘×¨×™×¨×ª ××—×“×œ: ×”×¨××©×•×Ÿ, ××• ××” ×©×”×™×” ×‘×—×•×¨ ×× ×§×™×™× ×‘×’×¨×£ ×”×—×“×©
                if (this.selectedStartNode && this.graph.nodes.includes(parseInt(this.selectedStartNode))) {
                    this.els.startSelect.value = this.selectedStartNode;
                } else {
                    this.els.startSelect.value = this.graph.nodes[0];
                }
            }

            changeStartNode() {
                this.selectedStartNode = parseInt(this.els.startSelect.value);
                this.reset();
            }

            getStartNode() {
                return parseInt(this.els.startSelect.value);
            }

            /* --- ×¦×™×•×¨ ×”×’×¨×£ --- */
            initGraph() {
                this.els.edges.innerHTML = '';
                this.els.nodes.innerHTML = '';

                this.graph.edges.forEach(e => {
                    const u = this.graph.pos[e.u], v = this.graph.pos[e.v];
                    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
                    g.innerHTML = `
                                <line x1="${u.x}" y1="${u.y}" x2="${v.x}" y2="${v.y}" class="edge" id="e-${e.u}-${e.v}" marker-end="url(#arrow)"></line>
                                <rect x="${(u.x + v.x) / 2 - 10}" y="${(u.y + v.y) / 2 - 10}" width="20" height="20" class="label-bg"></rect>
                                <text x="${(u.x + v.x) / 2}" y="${(u.y + v.y) / 2}" class="label-text">${e.w}</text>
                            `;
                    this.els.edges.appendChild(g);
                });

                this.graph.nodes.forEach(n => {
                    const p = this.graph.pos[n];
                    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
                    g.setAttribute("class", "group");
                    g.setAttribute("id", `n-${n}`);
                    g.setAttribute("transform", `translate(${p.x},${p.y})`);
                    g.innerHTML = `
                                <circle class="node-circle"></circle>
                                <text class="node-text">${n}</text>
                                <text class="node-badge" id="b-${n}" y="-42"></text>
                            `;
                    this.els.nodes.appendChild(g);
                });
            }

            /* --- ×œ×•×’×™×§×” --- */
            log(msg, type = 'l-info') {
                const d = document.createElement('div');
                d.className = `log-entry ${type}`;
                d.innerHTML = msg;
                this.els.log.appendChild(d);

                // **×¤×ª×¨×•×Ÿ ×”×’×œ×™×œ×” ×”×××™×Ÿ ×‘×™×•×ª×¨:** ×©×™××•×© ×‘-setTimeout ×§×¦×¨
                setTimeout(() => {
                    this.els.log.scrollTop = this.els.log.scrollHeight;
                }, 10);
            }

            updateDS(items, active) {
                this.els.ds.innerHTML = '';
                items.forEach(x => {
                    const el = document.createElement('div');
                    el.className = `ds-item ${x == active ? 'active' : ''}`;
                    el.textContent = x;
                    this.els.ds.appendChild(el);
                    if (x == active) el.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
                });
            }

            hlNode(id, cls) {
                const el = document.getElementById(`n-${id}`);
                if (!el) return;

                if (cls === '') {
                    el.classList.remove('active', 'visited', 'finished');
                } else {
                    el.classList.remove('active');
                    el.classList.add(cls);
                }
            }

            hlEdge(u, v, on) {
                const el = document.getElementById(`e-${u}-${v}`);
                if (!el) return;
                if (on) {
                    el.classList.add('active');
                    el.setAttribute('marker-end', 'url(#arrow-active)');
                }
                else {
                    el.classList.remove('active');
                    el.setAttribute('marker-end', 'url(#arrow)');
                }
            }

            badge(id, txt) {
                const el = document.getElementById(`b-${id}`);
                if (el) {
                    el.textContent = txt;
                    el.style.opacity = 1;
                }
            }

            reset() {
                this.stopAuto();
                this.els.log.innerHTML = '<div class="log-entry l-info">××•×ª×—×œ ××—×“×©. ×”××ª×Ÿ ×œ×¤×§×•×“×”.</div>';
                this.initGraph();
                this.updateDS([]);

                if (this.algo === 'Dijkstra') this.gen = this.runDijkstra();
                else if (this.algo === 'BFS') this.gen = this.runBFS();
                else if (this.algo === 'DFS') this.gen = this.runDFS();
                else if (this.algo === 'SCC') this.gen = this.runSCC();
                else if (this.algo === 'DAG') this.gen = this.runDAG();
                else if (this.algo === 'Bellman') this.gen = this.runBellman();

                const startNode = this.getStartNode();
                if (this.algo !== 'SCC') {
                    this.log(`×”××œ×’×•×¨×™×ª× <b>${this.algo}</b> ××•×›×Ÿ ×œ×¨×™×¦×” ××§×•×“×§×•×“ ${startNode}.`, 'l-info');
                } else {
                    this.log(`×”××œ×’×•×¨×™×ª× <b>SCC</b> ××•×›×Ÿ ×œ×¨×™×¦×”.`, 'l-info');
                }
            }

            toggleAuto() {
                if (this.isPlaying) this.stopAuto(); else this.startAuto();
            }

            startAuto() {
                if (!this.gen) this.reset();
                this.isPlaying = true;
                this.els.playBtn.innerHTML = 'â¸';
                this.loop();
            }

            stopAuto() {
                this.isPlaying = false;
                clearTimeout(this.timer);
                this.els.playBtn.innerHTML = 'â–¶';
            }

            manualStep() {
                if (this.isPlaying) this.stopAuto();
                this.step();
            }

            step() {
                if (!this.gen) return false;
                const res = this.gen.next();
                if (res.done) {
                    this.stopAuto();
                    return false;
                }
                return true;
            }

            loop() {
                if (!this.isPlaying) return;
                if (this.step()) {
                    const delay = 2600 - this.els.speed.value;
                    this.timer = setTimeout(() => this.loop(), delay);
                }
            }

            /* --- ××œ×’×•×¨×™×ª××™× --- */

            *runDijkstra() {
                const start = this.getStartNode();
                this.els.dsTitle.innerText = "Priority Queue";
                const d = {}, Q = new Set(this.graph.nodes);
                this.graph.nodes.forEach(n => { d[n] = Infinity; }); d[start] = 0;
                this.badge(start, '0');

                while (Q.size) {
                    let u = null, min = Infinity;
                    Q.forEach(n => { if (d[n] < min) { min = d[n]; u = n; } });

                    if (u === null || min === Infinity) break;
                    Q.delete(u);

                    this.hlNode(u, 'active');
                    this.updateDS(Array.from(Q), u);
                    this.log(`× ×‘×—×¨ ×§×•×“×§×•×“ <b>${u}</b> (××¨×—×§ ××™× ×™××œ×™: ${min})`, 'l-act');
                    yield;

                    const neighbors = this.graph.edges.filter(e => e.u === u);
                    for (let e of neighbors) {
                        if (!Q.has(e.v)) continue;
                        this.hlEdge(u, e.v, true);
                        const alt = d[u] + e.w;
                        this.log(`×‘×“×™×§×ª ×©×›×Ÿ ${e.v}: ×”×× ${d[u]} + ${e.w} < ${d[e.v]}?`, 'l-calc');
                        yield;
                        if (alt < d[e.v]) {
                            d[e.v] = alt;
                            this.badge(e.v, `d:${alt}`);
                            this.log(`×©×™×¤×•×¨ × ××¦×! ×”××¨×—×§ ×œ-${e.v} ×¢×•×“×›×Ÿ ×œ-<b>${alt}</b>`, 'l-success');
                        }
                        this.hlEdge(u, e.v, false);
                    }
                    this.hlNode(u, 'visited');
                }
                this.log("×”××œ×’×•×¨×™×ª× ×¡×™×™×. ×›×œ ×”××¨×—×§×™× ×—×•×©×‘×•.", 'l-success');
            }

            *runBFS() {
                const start = this.getStartNode();
                this.els.dsTitle.innerText = "Queue (FIFO)";
                const Q = [start], visited = new Set([start]);

                while (Q.length) {
                    this.updateDS([...Q], Q[0]);
                    const u = Q.shift();
                    this.hlNode(u, 'active');
                    this.log(`××•×¦×™× ××ª <b>${u}</b> ××”×ª×•×¨ ×•×¡×•×¨×§ ×©×›× ×™×`, 'l-act');
                    yield;

                    const neighbors = this.graph.edges.filter(e => e.u === u).map(e => e.v);
                    for (let v of neighbors) {
                        if (!visited.has(v)) {
                            this.hlEdge(u, v, true);
                            visited.add(v); Q.push(v);
                            this.updateDS([...Q], v);
                            this.log(`×”×ª×’×œ×” ×©×›×Ÿ ×—×“×© ${v} - ×”×•×›× ×¡ ×œ×ª×•×¨`, 'l-success');
                            yield;
                            this.hlEdge(u, v, false);
                        }
                    }
                    this.hlNode(u, 'visited');
                }
                this.log("×”×ª×•×¨ ×”×ª×¨×•×§×Ÿ. ×¡×¨×™×§×ª BFS ×”×¡×ª×™×™××”.", 'l-success');
            }

            *runDFS() {
                const start = this.getStartNode();
                this.els.dsTitle.innerText = "Stack (LIFO)";
                const stack = [start], visited = new Set();

                while (stack.length) {
                    const u = stack.pop();
                    this.updateDS([...stack, u], u);

                    if (!visited.has(u)) {
                        visited.add(u);
                        this.hlNode(u, 'active');
                        this.log(`×‘×™×§×•×¨ ×‘×§×•×“×§×•×“ <b>${u}</b> (× ×©×œ×£ ××”××—×¡× ×™×ª)`, 'l-act');
                        yield;

                        const neighbors = this.graph.edges.filter(e => e.u === u).map(e => e.v).reverse();
                        if (neighbors.length > 0) this.log(`××•×¡×™×£ ×©×›× ×™× ×œ××—×¡× ×™×ª: ${neighbors.join(', ')}`, 'l-calc');

                        for (let v of neighbors) {
                            if (!visited.has(v)) stack.push(v);
                        }
                        this.hlNode(u, 'visited');
                    } else {
                        this.log(`×§×•×“×§×•×“ ${u} ×›×‘×¨ × ×¡×¨×§, ××“×œ×’`, 'l-info');
                    }
                }
                this.log("×”××—×¡× ×™×ª ×¨×™×§×”. ×¡×¨×™×§×ª DFS ×”×¡×ª×™×™××”.", 'l-success');
            }

            *runSCC() {
                this.els.dsTitle.innerText = "Stack / Low-Link";
                let ids = {}, low = {}, stack = [], onStack = {}, id = 0, sccCount = 0;
                const visited = new Set(), that = this;

                function* dfs(at) {
                    stack.push(at); onStack[at] = true; visited.add(at);
                    ids[at] = low[at] = id++;
                    that.hlNode(at, 'active'); that.badge(at, `L:${low[at]}`);
                    that.updateDS(stack, at);
                    that.log(`×‘×™×§×•×¨ ×‘-${at}. ID:${ids[at]}, Low:${low[at]}`, 'l-act');
                    yield;

                    const neighbors = that.graph.edges.filter(e => e.u === at);
                    for (let e of neighbors) {
                        if (!visited.has(e.v)) {
                            that.hlEdge(at, e.v, true);
                            yield* dfs(e.v);
                            low[at] = Math.min(low[at], low[e.v]);
                            that.badge(at, `L:${low[at]}`);
                            that.log(`×—×–×¨×” ××¨×§×•×¨×¡×™×” (${e.v}). ×¢×“×›×•×Ÿ Low ×©×œ ${at} ×œ-${low[at]}`, 'l-calc');
                            that.hlNode(at, 'active'); yield;
                            that.hlEdge(at, e.v, false);
                        } else if (onStack[e.v]) {
                            low[at] = Math.min(low[at], ids[e.v]);
                            that.badge(at, `L:${low[at]}`);
                            that.log(`×§×©×ª ××—×•×¨×™×ª ×œ-${e.v}. ×¢×“×›×•×Ÿ Low ×œ-${low[at]}`, 'l-calc');
                            yield;
                        }
                    }
                    if (ids[at] === low[at]) {
                        that.log(`× ××¦× ×©×•×¨×© ×¨×›×™×‘ ×§×©×™×¨ ×‘-${at}! ××¨×•×§×Ÿ ××—×¡× ×™×ª...`, 'l-success');
                        while (stack.length) {
                            const node = stack.pop(); onStack[node] = false;
                            document.getElementById(`n-${node}`).setAttribute('data-scc', sccCount % 3);
                            that.updateDS(stack);
                            if (node === at) break; yield;
                        }
                        sccCount++;
                    }
                }
                for (let n of this.graph.nodes) if (!visited.has(n)) yield* dfs(n);
                this.log(`×¡×™×•×. × ××¦××• ${sccCount} ×¨×›×™×‘×™× ×§×©×™×¨×™×.`, 'l-success');
            }

            *runDAG() {
                const start = this.getStartNode();
                this.els.dsTitle.innerText = "Topo Sort";
                const inDegree = {}; this.graph.nodes.forEach(n => inDegree[n] = 0);
                this.graph.edges.forEach(e => inDegree[e.v]++);
                const q = this.graph.nodes.filter(n => inDegree[n] === 0);
                const topo = [];

                this.log("×©×œ×‘ 1: ××™×•×Ÿ ×˜×•×¤×•×œ×•×’×™ (Kahn's Algo)", 'l-info');
                while (q.length) {
                    const u = q.shift(); topo.push(u);
                    this.hlNode(u, 'finished'); this.updateDS(topo, u);
                    yield;
                    this.graph.edges.filter(e => e.u === u).forEach(e => {
                        inDegree[e.v]--; if (inDegree[e.v] === 0) q.push(e.v);
                    });
                }

                this.log("×©×œ×‘ 2: ×—×™×©×•×‘ ××¨×—×§×™× ×œ×¤×™ ×¡×“×¨ ×˜×•×¤×•×œ×•×’×™", 'l-info');
                this.graph.nodes.forEach(n => this.hlNode(n, ''));
                const d = {}; this.graph.nodes.forEach(n => d[n] = Infinity); d[start] = 0;
                this.badge(start, '0');

                for (let u of topo) {
                    if (d[u] === Infinity) {
                        this.log(`××“×œ×’ ×¢×œ ${u} (×œ× × ×’×™×© ×× ×§×•×“×ª ×”×”×ª×—×œ×”)`, 'l-info');
                        continue;
                    }
                    this.hlNode(u, 'active');
                    this.log(`××¢×‘×“ ××ª ${u} (××¨×—×§ × ×•×›×—×™: ${d[u]})`, 'l-act');
                    yield;

                    const neighbors = this.graph.edges.filter(e => e.u === u);
                    for (let e of neighbors) {
                        this.hlEdge(u, e.v, true);
                        if (d[u] + e.w < d[e.v]) {
                            d[e.v] = d[u] + e.w;
                            this.badge(e.v, `d:${d[e.v]}`);
                            this.log(`Relaxation: ${u}->${e.v} ×¢×•×“×›×Ÿ ×œ-${d[e.v]}`, 'l-success');
                        }
                        yield; this.hlEdge(u, e.v, false);
                    }
                    this.hlNode(u, 'visited');
                }
                this.log("×¡×™×•× DAG Shortest Path.", 'l-success');
            }

            *runBellman() {
                const start = this.getStartNode();
                const d = {}; this.graph.nodes.forEach(n => { d[n] = Infinity; this.badge(n, 'âˆ'); });
                d[start] = 0; this.badge(start, '0');

                this.log(`××ª×—×™×œ Bellman-Ford ×-${start}. ×‘×™×¦×•×¢ ×¢×“ |V|-1 ××™×˜×¨×¦×™×•×ª.`, 'l-info');

                for (let i = 1; i < this.graph.nodes.length; i++) {
                    this.log(`--- ××™×˜×¨×¦×™×” ${i} ---`, 'l-info');
                    this.updateDS([`Iter: ${i}`], `Iter: ${i}`);
                    let changed = false;

                    for (let e of this.graph.edges) {
                        if (d[e.u] === Infinity) continue;

                        this.hlEdge(e.u, e.v, true); this.hlNode(e.u, 'active');
                        if (d[e.u] + e.w < d[e.v]) {
                            d[e.v] = d[e.u] + e.w;
                            this.badge(e.v, `d:${d[e.v]}`);
                            this.log(`×©×™×¤×•×¨ ×‘×§×©×ª ${e.u}->${e.v}. ××¨×—×§ ×—×“×©: <b>${d[e.v]}</b>`, 'l-success');
                            changed = true;
                        }
                        yield; this.hlEdge(e.u, e.v, false); this.hlNode(e.u, '');
                    }
                    if (!changed) { this.log("×œ× ×”×™×• ×©×™× ×•×™×™×. ×¢×¦×™×¨×” ××•×§×“××ª.", 'l-success'); break; }
                }

                // ×‘×“×™×§×ª ××¢×’×œ ×©×œ×™×œ×™
                for (let e of this.graph.edges) {
                    if (d[e.u] !== Infinity && d[e.u] + e.w < d[e.v]) {
                        this.log("âš ï¸ ×–×•×”×” ××¢×’×œ ×©×œ×™×œ×™! ×œ× × ×™×ª×Ÿ ×œ×—×©×‘ ××¡×œ×•×œ.", 'l-err');
                        return;
                    }
                }
            }
        }

        const app = new App();
    </script>
</body>
</html>
