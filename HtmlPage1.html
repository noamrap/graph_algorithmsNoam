<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI TradeCommand - Deep Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;500;700&family=Share+Tech+Mono&family=Assistant:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #040712;
            --bg-gradient: radial-gradient(circle at 10% 0%, #1a345a 0, transparent 55%),
                           radial-gradient(circle at 90% 100%, #4a1638 0, transparent 55%),
                           linear-gradient(135deg, #020308 0, #050816 60%, #020308 100%);
            --panel-bg: rgba(13, 19, 34, 0.82);
            --panel-bg-strong: rgba(8, 12, 24, 0.95);
            --border-color: rgba(0, 242, 255, 0.18);
            --neon-green: #00ff9d;
            --neon-blue: #00f2ff;
            --neon-red: #ff2a6d;
            --neon-yellow: #fcee0a;
            --accent-soft: #7dd3fc;
            --text-main: #e2e8f0;
            --text-muted: #94a3b8;
            --shadow-strong: 0 18px 45px rgba(0,0,0,0.8);
            --radius-lg: 18px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            background: var(--bg-gradient);
            color: var(--text-main);
            font-family: 'Exo 2', sans-serif;
            min-height: 100vh;
            display: flex;
        }

        /* --- Sidebar --- */
        .sidebar {
            width: 76px;
            background: linear-gradient(to bottom, rgba(10, 20, 40, 0.9), rgba(5, 10, 20, 0.95));
            border-inline-start: 1px solid rgba(148, 163, 184, 0.18);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 10px;
            gap: 12px;
            backdrop-filter: blur(16px);
            box-shadow: 8px 0 30px rgba(0,0,0,0.8);
            z-index: 20;
        }

        .logo-mark {
            width: 42px;
            height: 42px;
            border-radius: 14px;
            border: 1px solid rgba(148,163,184,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.8rem;
            color: var(--neon-blue);
            box-shadow: 0 0 16px rgba(0,242,255,0.35);
            background: radial-gradient(circle at 20% 0, rgba(0,242,255,0.25) 0, transparent 60%),
                        rgba(15,23,42,0.9);
        }

        .sidebar-label {
            margin-top: 6px;
            font-size: 0.65rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .nav-section-title {
            font-size: 0.65rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: #64748b;
            margin-top: 22px;
            margin-bottom: 4px;
        }

        .nav-btn {
            width: 46px;
            height: 46px;
            border-radius: 14px;
            border: 1px solid rgba(148,163,184,0.25);
            background: radial-gradient(circle at 20% 0, rgba(148,163,184,0.2) 0, transparent 60%),
                        rgba(15,23,42, 0.9);
            color: #94a3b8;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover {
            color: var(--neon-blue);
            border-color: rgba(56,189,248,0.8);
            box-shadow: 0 0 16px rgba(56,189,248,0.4);
            transform: translateY(-1px);
        }

        .nav-btn.active {
            color: var(--neon-green);
            border-color: rgba(34,197,94,0.9);
            box-shadow: 0 0 18px rgba(34,197,94,0.45);
        }

        .sidebar-spacer {
            flex: 1;
        }

        .side-indicator {
            font-size: 0.65rem;
            color: var(--text-muted);
            writing-mode: vertical-rl;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            opacity: 0.65;
        }

        /* --- Main Layout --- */
        .main-content {
            flex: 1;
            padding: 16px 18px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            position: relative;
        }

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .top-title-block {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .app-title {
            font-size: 1.2rem;
            font-weight: 600;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .app-subtitle {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .ai-status-chip {
            padding: 6px 10px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 1px solid rgba(34,197,94,0.8);
            background: radial-gradient(circle at 0 0, rgba(34,197,94,0.25) 0, transparent 55%),
                        rgba(15,23,42,0.95);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .ai-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--neon-green);
            box-shadow: 0 0 12px rgba(34,197,94,0.9);
        }

        .top-right-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .pill-btn {
            border-radius: 999px;
            padding: 7px 14px;
            border: 1px solid rgba(148,163,184,0.6);
            background: rgba(15,23,42, 0.8);
            color: var(--text-main);
            font-size: 0.78rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: 0.2s;
        }
        .pill-btn:hover {
            border-color: rgba(56,189,248,0.9);
            color: var(--accent-soft);
        }

        /* --- Ticker --- */
        .ticker-wrap {
            height: 38px;
            background: linear-gradient(90deg, rgba(15,23,42,0.95), rgba(15,23,42,0.8));
            border-radius: 999px;
            display: flex;
            align-items: center;
            overflow: hidden;
            border: 1px solid rgba(148, 163, 184, 0.35);
            box-shadow: 0 12px 35px rgba(15,23,42, 0.8);
            padding-inline: 10px;
        }

        .ticker-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.18em;
            color: var(--text-muted);
            margin-inline-end: 12px;
            white-space: nowrap;
        }

        #ticker {
            animation: scroll 25s linear infinite;
            white-space: nowrap;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.85rem;
        }

        .ticker-item {
            padding-inline: 1.4rem;
        }

        .val-up { color: var(--neon-green); }
        .val-down { color: var(--neon-red); }

        /* --- Dashboard Grid --- */
        .dashboard-grid {
            flex: 1;
            display: grid;
            grid-template-columns: 1.4fr 1.1fr 1.2fr;
            grid-template-rows: 1.8fr 1fr;
            gap: 14px;
            margin-top: 6px;
            min-height: 0;
        }

        .panel {
            background: var(--panel-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            padding: 14px 16px;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-strong);
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: "";
            position: absolute;
            inset: -20%;
            background:
                radial-gradient(circle at 0 0, rgba(59,130,246,0.08) 0, transparent 55%),
                radial-gradient(circle at 100% 100%, rgba(236,72,153,0.06) 0, transparent 55%);
            pointer-events: none;
            opacity: 0.9;
        }

        .panel-inner {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .panel-header {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(148,163,184,0.25);
            padding-bottom: 8px;
        }

        .panel-header span:first-child {
            letter-spacing: 0.16em;
        }

        .panel-tag {
            font-size: 0.7rem;
            padding: 3px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.4);
            color: var(--accent-soft);
        }

        /* --- Asset List --- */
        #assetList {
            overflow-y: auto;
            padding-right: 2px;
            margin-top: 4px;
        }

        .asset-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 9px 4px;
            border-bottom: 1px solid rgba(148,163,184,0.22);
            transition: 0.2s;
        }
        .asset-item:last-child {
            border-bottom: none;
        }

        .asset-item:hover {
            background: radial-gradient(circle at 0 0, rgba(56,189,248,0.08) 0, transparent 60%);
            transform: translateY(-1px);
        }

        .asset-primary {
            font-weight: 600;
            font-size: 0.95rem;
        }
        .asset-secondary {
            font-size: 0.73rem;
            color: var(--text-muted);
        }

        .asset-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .asset-price {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.85rem;
        }

        .btn-analyze-small {
            background: rgba(15,23,42, 0.9);
            border: 1px solid rgba(56,189,248,0.8);
            color: var(--accent-soft);
            border-radius: 999px;
            padding: 3px 10px;
            cursor: pointer;
            font-size: 0.72rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: 0.18s;
        }
        .btn-analyze-small i {
            font-size: 0.75rem;
        }
        .btn-analyze-small:hover {
            background: var(--neon-blue);
            color: #020617;
            box-shadow: 0 0 14px rgba(56,189,248,0.9);
            transform: translateY(-1px);
        }

        /* --- Chart --- */
        .chart-main {
            grid-column: 1 / 3;
            grid-row: 1 / 2;
        }

        .chart-wrapper {
            position: relative;
            flex: 1;
            min-height: 260px;
            max-height: 100%;
        }

        #mainChart {
            width: 100% !important;
            height: 100% !important;
        }

        .chart-footer-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .chart-footer-row span strong {
            color: var(--accent-soft);
        }

        /* --- KPIs --- */
        .controls-area {
            grid-column: 1 / 3;
            grid-row: 2 / 3;
            display: grid;
            grid-template-columns: 1.1fr 1fr;
            gap: 14px;
        }

        .kpi-block {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            text-align: left;
            gap: 3px;
        }

        .kpi-label {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .big-stat {
            font-size: 2.1rem;
            font-weight: 700;
            font-family: 'Share Tech Mono', monospace;
        }

        .big-stat.green { color: var(--neon-green); }
        .big-stat.white { color: #f9fafb; }

        .kpi-sub {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* --- Logs --- */
        .log-panel {
            grid-column: 3 / 4;
            grid-row: 1 / 3;
        }

        #logs {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.78rem;
            color: #9ca3af;
            overflow-y: auto;
            margin-top: 6px;
            padding-right: 4px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            height: 100%;
        }

        .log-entry {
            white-space: nowrap;
        }

        .log-entry span.tag {
            color: var(--accent-soft);
        }

        /* --- MODAL POPUP --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(3,4,11, 0.93);
            backdrop-filter: blur(14px);
            z-index: 100;
            justify-content: center;
            align-items: center;
            padding: 14px;
        }

        .modal-box {
            background: var(--panel-bg-strong);
            border: 1px solid rgba(56, 189, 248, 0.7);
            width: 520px;
            max-width: 100%;
            padding: 1px;
            position: relative;
            transform: scale(0.85);
            opacity: 0;
            transition: all 0.27s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 30px 80px rgba(0,0,0,0.95);
            border-radius: 20px;
        }

        .modal-inner {
            background:
                radial-gradient(circle at 0 0, rgba(56,189,248,0.1) 0, transparent 55%),
                radial-gradient(circle at 100% 0, rgba(251,113,133,0.08) 0, transparent 55%),
                #020617;
            padding: 24px 24px 22px;
            position: relative;
            overflow: hidden;
            border-radius: 20px;
        }

        .modal-scan-line {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(to right, transparent, var(--neon-blue), transparent);
            opacity: 0.7;
            box-shadow: 0 0 14px var(--neon-blue);
            animation: scanDown 2.2s ease-in-out infinite;
            pointer-events: none;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(148,163,184,0.35);
            padding-bottom: 12px;
            margin-bottom: 18px;
        }

        .modal-header-left small {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.18em;
        }

        #modalTitle {
            margin: 3px 0 0;
            font-size: 1.9rem;
            letter-spacing: 0.12em;
        }

        .prediction-badge {
            padding: 6px 15px;
            border-radius: 999px;
            font-weight: bold;
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            border-width: 1px;
            border-style: solid;
        }
        
        .badge-buy { background: rgba(0, 255, 157, 0.15); color: var(--neon-green); border-color: rgba(0, 255, 157, 0.65); }
        .badge-sell { background: rgba(255, 42, 109, 0.16); color: var(--neon-red); border-color: rgba(255, 42, 109, 0.7); }
        .badge-hold { background: rgba(252, 238, 10, 0.18); color: var(--neon-yellow); border-color: rgba(252, 238, 10, 0.8); }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 18px;
        }

        .data-point label {
            display: block;
            color: var(--text-muted);
            font-size: 0.75rem;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
        }

        .data-point span {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.05rem;
        }

        .typing-container {
            background: rgba(15,23,42,0.9);
            border: 1px solid rgba(148,163,184,0.5);
            padding: 12px 11px 11px;
            font-family: 'Assistant', sans-serif;
            line-height: 1.6;
            min-height: 76px;
            position: relative;
            border-radius: 14px;
            font-size: 0.85rem;
        }
        
        .typing-container::before {
            content: "AI CONCLUSION";
            position: absolute;
            top: -9px;
            right: 14px;
            background: #020617;
            padding: 0 6px;
            font-size: 0.68rem;
            color: var(--neon-blue);
            letter-spacing: 0.18em;
        }

        #typewriterText {
            white-space: pre-wrap;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #9ca3af;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            transition: 0.15s;
        }
        .close-btn:hover {
            color: #e5e7eb;
            transform: scale(1.08);
        }

        .modal-action-btn {
            width: 100%;
            padding: 13px 0;
            margin-top: 18px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-green));
            border: none;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 999px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: #020617;
            box-shadow: 0 0 22px rgba(34,197,94,0.6);
            transition: 0.2s;
        }
        .modal-action-btn:hover {
            filter: brightness(1.06);
            transform: translateY(-1px);
        }

        @keyframes scanDown {
            0% { top: -10%; opacity: 0; }
            40% { opacity: 0.9; }
            100% { top: 106%; opacity: 0; }
        }

        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* --- Responsive --- */
        @media (max-width: 1024px) {
            body {
                flex-direction: column;
            }

            .sidebar {
                flex-direction: row;
                width: 100%;
                height: auto;
                padding: 10px 14px;
                justify-content: space-between;
                box-shadow: 0 6px 26px rgba(0,0,0,0.85);
            }

            .sidebar-spacer,
            .side-indicator,
            .sidebar-label,
            .nav-section-title {
                display: none;
            }

            .main-content {
                padding: 12px 12px 16px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }

            .chart-main {
                grid-column: 1 / 2;
                grid-row: 1 / 2;
            }
            .controls-area {
                grid-column: 1 / 2;
                grid-row: 2 / 3;
                grid-template-columns: 1fr;
            }
            .log-panel {
                grid-column: 1 / 2;
                grid-row: 3 / 4;
            }
        }

        @media (max-width: 640px) {
            .app-title {
                font-size: 1rem;
            }
            .ticker-label {
                display: none;
            }
            .chart-wrapper {
                min-height: 220px;
            }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div>
            <div class="logo-mark">AI</div>
            <div class="sidebar-label">TRADE CMD</div>
        </div>

        <div class="nav-section-title">MODES</div>
        <button class="nav-btn active"><i class="fas fa-satellite-dish"></i></button>
        <button class="nav-btn"><i class="fas fa-chart-area"></i></button>

        <div class="sidebar-spacer"></div>

        <div class="side-indicator">DEEP ANALYSIS</div>
    </div>

    <div class="main-content">
        <div class="top-bar">
            <div class="top-title-block">
                <div class="app-title">AI TRADECOMMAND</div>
                <div class="app-subtitle">ניתוח עומק חצי-אוטומטי של מניות, קריפטו ואינדקסים</div>
            </div>
            <div class="top-right-actions">
                <div class="ai-status-chip">
                    <span class="ai-dot"></span>
                    <span>AI MODE: ACTIVE</span>
                </div>
                <button class="pill-btn">
                    <i class="fas fa-robot"></i>
                    מצב אוטומציה
                </button>
            </div>
        </div>
        
        <div class="ticker-wrap">
            <div class="ticker-label">LIVE TICKER</div>
            <div id="ticker"></div>
        </div>

        <div class="dashboard-grid">
            
            <!-- Assets -->
            <div class="panel">
                <div class="panel-inner">
                    <div class="panel-header">
                        <span>נכסים זמינים לניתוח</span>
                        <span class="panel-tag"><i class="fas fa-search"></i> AI WATCHLIST</span>
                    </div>
                    <div id="assetList"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="panel chart-main">
                <div class="panel-inner">
                    <div class="panel-header">
                        <span>ניתוח טכני ראשי</span>
                        <span class="panel-tag"><i class="fas fa-wave-square"></i> REAL-TIME FEED</span>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="mainChart"></canvas>
                    </div>
                    <div class="chart-footer-row">
                        <span>מצב תצוגה: <strong>VOL / PRICE ACTION (LIVE)</strong></span>
                        <span>רענון כל 0.5 שניות · נתונים מדומים לצורך הדגמה</span>
                    </div>
                </div>
            </div>

            <!-- KPIs -->
            <div class="panel controls-area">
                <div class="panel-inner">
                    <div class="kpi-block">
                        <div class="kpi-label">רווח יומי משוער</div>
                        <div class="big-stat green">+$1,240.50</div>
                        <div class="kpi-sub">מבוסס על אסטרטגיית AI Momentum · תיק מדומה</div>
                    </div>
                </div>
                <div class="panel-inner">
                    <div class="kpi-block">
                        <div class="kpi-label">עסקאות פתוחות</div>
                        <div class="big-stat white">3</div>
                        <div class="kpi-sub">חשיפה ממוצעת לנכס: 18.4% · רמת מינוף: x3.2</div>
                    </div>
                </div>
            </div>

            <!-- Logs -->
            <div class="panel log-panel">
                <div class="panel-inner">
                    <div class="panel-header">
                        <span>LIVE FEED</span>
                        <span class="panel-tag"><i class="fas fa-terminal"></i> SYSTEM LOG</span>
                    </div>
                    <div id="logs"></div>
                </div>
            </div>

        </div>
    </div>

    <!-- MODAL -->
    <div class="modal-overlay" id="predictionModal">
        <div class="modal-box">
            <div class="modal-inner">
                <div class="modal-scan-line"></div>
                <button class="close-btn" onclick="closeModal()"><i class="fas fa-times"></i></button>
                
                <div class="modal-header">
                    <div class="modal-header-left">
                        <small>AI PREDICTION · NEXT 24H</small>
                        <h1 id="modalTitle">NVDA</h1>
                    </div>
                    <div id="modalBadge" class="prediction-badge badge-buy">STRONG BUY</div>
                </div>

                <div class="analysis-grid">
                    <div class="data-point">
                        <label>מחיר יעד (24h)</label>
                        <span id="modalTarget" style="color: var(--neon-green)">$148.20</span>
                    </div>
                    <div class="data-point">
                        <label>רמת סיכון</label>
                        <span id="modalRisk" style="color: orange">MEDIUM</span>
                    </div>
                    <div class="data-point">
                        <label>וודאות אלגוריתם</label>
                        <span id="modalConfidence">94.2%</span>
                    </div>
                    <div class="data-point">
                        <label>נפח מסחר</label>
                        <span>High Volatility</span>
                    </div>
                </div>

                <div class="typing-container">
                    <span id="typewriterText"></span><span style="animation: blink 1s infinite">|</span>
                </div>

                <button class="modal-action-btn" onclick="closeModal()">
                    ביצוע פעולה בתיק השקעות
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA & CONFIG ---
        const stocks = [
            { symbol: 'BTC', price: 94320, change: '+2.1%', name: 'Bitcoin Core' },
            { symbol: 'ETH', price: 3450, change: '+1.4%', name: 'Ethereum' },
            { symbol: 'NVDA', price: 142.50, change: '+0.8%', name: 'NVIDIA Corp' },
            { symbol: 'TSLA', price: 210.20, change: '-3.2%', name: 'Tesla Inc' },
            { symbol: 'PLTR', price: 62.40, change: '+5.5%', name: 'Palantir Tech' },
            { symbol: 'AAPL', price: 225.00, change: '-0.2%', name: 'Apple Inc' },
        ];

        const predictions = {
            'BTC': {
                action: 'HOLD',
                badgeClass: 'badge-hold',
                target: '$95,100',
                risk: 'High',
                confidence: '78%',
                text: 'זוהתה התנגדות סביב $94,500 עם תנודתיות מוגברת. נפח המסחר נשאר גבוה לצד פעילות לוויתנים משמעותית בבורסת Binance. ההמלצה: להמתין לפריצת התנגדות ברורה לפני כניסה אגרסיבית לפוזיציה חדשה.'
            },
            'NVDA': {
                action: 'STRONG BUY',
                badgeClass: 'badge-buy',
                target: '$155.00',
                risk: 'Low',
                confidence: '96%',
                text: 'ביקוש חזק לשבבי H100 ומערכת אספקה יציבה משמרים מומנטום חיובי. האלגוריתם מזהה צבירת פוזיציות מוסדיות ופריצת רמת התנגדות טכנית. צפי להמשך עלייה בטווח 24–48 שעות, עם סיכון נמוך יחסית לתנודתיות חריגה.'
            },
            'TSLA': {
                action: 'SELL',
                badgeClass: 'badge-sell',
                target: '$198.00',
                risk: 'Very High',
                confidence: '82%',
                text: 'ירידה בסנטימנט החיובי עקב דיווחים על עיכובים בייצור Cybertruck. שילוב של שבירת קו מגמה עולה עם ירידה בנפח מסחר תומך בתרחיש תיקון. ההמלצה: לממש רווחים חלקיים ולהקטין חשיפה עד להתייצבות המחיר.'
            },
            'PLTR': {
                action: 'BUY',
                badgeClass: 'badge-buy',
                target: '$68.50',
                risk: 'Medium',
                confidence: '89%',
                text: 'זכייה במכרז ממשלתי משמעותי מגדילה את הוודאות להכנסות עתידיות. נפח המסחר זינק בכ-200% בשעה האחרונה וה-RSI מאותת על כניסת הון מוסדי. מתאים לפתיחת פוזיציית BUY מדורגת עם ניהול סיכונים הדוק.'
            },
            'ETH': {
                action: 'BUY',
                badgeClass: 'badge-buy',
                target: '$3,600',
                risk: 'Medium',
                confidence: '85%',
                text: 'שדרוג רשת מתקרב ומעלה את הביקוש לחוזים חכמים. עמלות הגז נמצאות ברמה נוחה, מה שמגדיל שימוש בפלטפורמה. המלצה: כניסה מדורגת עם מעקב צמוד אחרי תגובת השוק לשחרור השדרוג.'
            },
            'AAPL': {
                action: 'HOLD',
                badgeClass: 'badge-hold',
                target: '$226.00',
                risk: 'Low',
                confidence: '60%',
                text: 'השוק ממתין לאירועי הכרזה נוספים בתחום ה-VR/AR. אין תנועות חריגות במחזורי המסחר או בסטיות התקן. בשלב זה האלגוריתם מציע להמתין מחוץ לשוק עד לאות חזק יותר של כיוון מחיר.'
            }
        };

        const assetList = document.getElementById('assetList');
        const ticker = document.getElementById('ticker');

        // Populate Assets & Ticker
        stocks.forEach(s => {
            const div = document.createElement('div');
            div.className = 'asset-item';
            div.innerHTML = `
                <div>
                    <div class="asset-primary">${s.symbol}</div>
                    <div class="asset-secondary">${s.name}</div>
                </div>
                <div class="asset-actions">
                    <span class="asset-price">$${s.price}</span>
                    <button class="btn-analyze-small" onclick="analyzeStock('${s.symbol}')">
                        <i class="fas fa-crosshairs"></i> חיזוי
                    </button>
                </div>
            `;
            assetList.appendChild(div);

            const color = s.change.includes('+') ? 'val-up' : 'val-down';
            ticker.innerHTML += `<span class="ticker-item">${s.symbol} <span class="${color}">${s.change}</span></span>`;
        });
        ticker.innerHTML += ticker.innerHTML; // duplicate for continuous scroll

        // --- CHART SETUP ---
        const ctx = document.getElementById('mainChart').getContext('2d');
        const grad = ctx.createLinearGradient(0,0,0,300);
        grad.addColorStop(0, 'rgba(0, 242, 255, 0.35)');
        grad.addColorStop(1, 'rgba(0, 242, 255, 0)');

        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: Array(40).fill(''),
                datasets: [{
                    data: Array(40).fill(100).map(() => 100 + Math.random()*20),
                    borderColor: '#38bdf8',
                    backgroundColor: grad,
                    fill: true,
                    tension: 0.45,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: {
                        display: false
                    },
                    y: {
                        grid: { color: 'rgba(148,163,184,0.25)' },
                        ticks: {
                            color: '#94a3b8',
                            font: { size: 10 }
                        }
                    }
                },
                animation: false
            }
        });

        setInterval(() => {
            const data = chart.data.datasets[0].data;
            data.shift();
            const last = data[data.length - 1];
            data.push(last + (Math.random() - 0.5) * 4);
            chart.update();
        }, 500);

        // --- MODAL LOGIC ---
        const modal = document.getElementById('predictionModal');
        const modalBox = document.querySelector('.modal-box');
        let typeInterval = null;
        
        function analyzeStock(symbol) {
            modal.style.display = 'flex';
            setTimeout(() => {
                modalBox.style.opacity = '1';
                modalBox.style.transform = 'scale(1)';
            }, 10);

            const data = predictions[symbol] || predictions['NVDA'];
            document.getElementById('modalTitle').innerText = symbol;
            
            const badge = document.getElementById('modalBadge');
            badge.className = `prediction-badge ${data.badgeClass}`;
            badge.innerText = data.action;

            document.getElementById('modalTarget').innerText = data.target;
            document.getElementById('modalRisk').innerText = data.risk;
            document.getElementById('modalConfidence').innerText = data.confidence;

            const typeEl = document.getElementById('typewriterText');
            typeEl.innerText = '';
            let i = 0;
            const text = data.text;
            
            if (typeInterval) clearInterval(typeInterval);
            typeInterval = setInterval(() => {
                if (i < text.length) {
                    typeEl.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(typeInterval);
                }
            }, 28);
        }

        function closeModal() {
            modalBox.style.opacity = '0';
            modalBox.style.transform = 'scale(0.85)';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 260);
        }

        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        // --- BACKGROUND LOGS ---
        const logContainer = document.getElementById('logs');
        const msgs = [
            "Scanning blockchain transaction graph...",
            "Analysing sentiment across Twitter & Reddit...",
            "Updating volatility and risk matrices...",
            "Pulling order book depth from exchanges...",
            "Evaluating AI momentum indicators...",
            "Recalculating Sharpe ratio and VAR..."
        ];

        setInterval(() => {
            const div = document.createElement('div');
            div.className = 'log-entry';
            const msg = msgs[Math.floor(Math.random()*msgs.length)];
            const latency = (20 + Math.random()*120).toFixed(1);
            div.innerHTML = `<span class="tag">&gt;</span> ${msg} <span class="tag">[${latency}ms]</span>`;
            logContainer.appendChild(div);
            if(logContainer.children.length > 30) logContainer.removeChild(logContainer.firstChild);
            logContainer.scrollTop = logContainer.scrollHeight;
        }, 2200);
    </script>
</body>
</html>
